<script>
  function showUser(data) {
    document.getElementById("user").innerHTML = data.email;
  }

  function generateInstituteSelect(data) { // створюємо випадний список для вибору інституту
    const institutes = Object.values(data).map(el => {
      return {
        key: el.idinstitute,
        value: el.nameinstitute
      }
    });
    institutes.unshift({
      key: 0,
      value: "Виберіть інститут"
    });
    document.getElementById("institute").innerHTML = generateSelect(institutes, "select-institute");
  }

  function generateEducationalDegreeSelect(data) { // створюємо випадний список для вибору освітнього ступеня
    const educationalDegree = Object.values(data).map(el => {
      return {
        key: el.educationaldegreeid,
        value: el.educationaldegreename
      }
    });
    educationalDegree.unshift({
      key: 0,
      value: "Виберіть освітній рівень"
    });
    document.getElementById("educationalDegree").innerHTML = generateSelect(educationalDegree,
      "select-educationalDegree");
  }

  function generateFormTrainingSelect(data) { // створюємо випадний список для вибору форми навчання
    const formTraining = Object.values(data).map(el => {
      return {
        key: el.formtrainingid,
        value: el.formtrainingname
      }
    });
    formTraining.unshift({
      key: 0,
      value: "Виберіть форму навчання"
    });
    document.getElementById("formTraining").innerHTML = generateSelect(formTraining, "select-formTraining");
  }

  function generateGroupsSelect(data) { // створюємо випадний список для вибору групи
    const groups = Object.values(data).map(el => {
      return {
        key: el.groupId,
        value: el.name
      }
    });
    groups.unshift({
      key: 0,
      value: "Виберіть групу"
    });
    document.getElementById("groups").innerHTML = generateSelect(groups, "select-groups");
  }

  function generateAddButton() {
    document.getElementById("buttonsAddForm").innerHTML = "<button name='createForm'>Plus</button>"
  }

  function generateForm() {
    let data = evaluationListData,
      controlFormData = handBook.controlForm,
      formButtons,
      form,
      tableHeader = ["№", "Прізвище, ініціали студента", "Поточний контроль", "Підсумковий семестровий контроль",
        "Загальна оцінка"
      ],
      result,
      tableMain = [],
      num = 1;

    formButtons = `<button name='closeForm'>Закрити</button>
      <button name='saveForm'>Зберегти</button>
      <button name='subscribe'>Підписати</button>`;

    form =
      `<div class="row"><label for="academicDiscipline">Навчальна дисципліна</label><input type="text" id="academicDiscipline" placeholder="повна назва дисципліни за навчальним планом" value="${data.academicDiscipline}"></div>`;

    controlFormData.unshift({
      key: 0,
      value: "Форма підсумкового контролю"
    });
    form += generateSelect(controlFormData, "controlForm");
    form +=
      `<div class="row"><label for="date">Дата контролю</label><input type="text" id="date" value="${data.date}"></div>
      <div class="row"><label for="teacherFullName">посади і ПІБ викладачів, які виставляють підсумкову оцінку</label><input type="text" id="teacherFullName" value="${data.teacherFullName}"></div>
      <div class="row"><label for="aditionalTeachers">посади і ПІБ викладачів, які проводили практичні (семінарські, лабораторні) заняття й здійснювали поточний контроль</label><input type="text" id="aditionalTeachers" placeholder="введіть через кому" value="${data.aditionalTeachers.join(", ")}"></div>`;

    data.students.forEach(el => {
      result = Object.keys(el).map(function (key) {
        return el[key];
      });
      result.splice(1, 1);
      result.unshift(num);
      result[2] = `<input type="text" name="tableInput" id="${"currentGrade-" + num}" value="${el.currentGrade}">`;
      result[3] =
        `<input type="text" name="tableInput" id="${"semesterGrade-" + num}" value="${el.semesterGrade}">`;
      result[4] = `<input type="text" name="tableInput" id="${"gradeSum-" + num}" value="${el.gradeSum}" disabled>`;
      ++num;
      tableMain.push(result);
    });
    tableMain.unshift(tableHeader);
    form += createTable(tableMain, "formTable");

    document.getElementById("form").innerHTML = form;
    document.getElementById("controlForm").value = +data.controlForm;
  }
</script>