<script>
  function showUser(data) {
    document.getElementById("user").innerHTML = data.email;
  }

  function generateInstituteSelect(data) { // створюємо випадний список для вибору інституту
    const institutes = Object.values(data).map(el => {
      return {
        key: el.idinstitute,
        value: el.nameinstitute
      }
    });
    institutes.unshift({
      key: 0,
      value: "Виберіть інститут"
    });
    document.getElementById("institute").innerHTML = generateSelect(institutes, "select-institute");
  }

  function generateEducationalDegreeSelect(data) { // створюємо випадний список для вибору освітнього ступеня
    const educationalDegree = Object.values(data).map(el => {
      return {
        key: el.educationaldegreeid,
        value: el.educationaldegreename
      }
    });
    educationalDegree.unshift({
      key: 0,
      value: "Виберіть освітній рівень"
    });
    document.getElementById("educationalDegree").innerHTML = generateSelect(educationalDegree,
      "select-educationalDegree");
  }

  function generateFormTrainingSelect(data) { // створюємо випадний список для вибору форми навчання
    const formTraining = Object.values(data).map(el => {
      return {
        key: el.formtrainingid,
        value: el.formtrainingname
      }
    });
    formTraining.unshift({
      key: 0,
      value: "Виберіть форму навчання"
    });
    document.getElementById("formTraining").innerHTML = generateSelect(formTraining, "select-formTraining");
  }

  function generateGroupsSelect(data) { // створюємо випадний список для вибору групи
    const groups = Object.values(data).map(el => {
      return {
        key: el.groupId,
        value: el.name
      }
    });
    groups.unshift({
      key: 0,
      value: "Виберіть групу"
    });
    document.getElementById("groups").innerHTML = generateSelect(groups, "select-groups");
  }

  function generateAddButtons(names) {
    let buttons = [];
    names.forEach(el => {
      buttons.push(Object.keys(el).map(function (key) {
        return `<button name='${key}'>${el[key]}</button>`;
      }).join(""));
    });
    document.getElementById("buttonsAddForm").innerHTML = buttons.join("");
  }

  function generateForm() {
    let data = cloneObj(evaluationListData), // evaluationListData recordData
      controlFormData = cloneObj(handBook.controlForm),
      formButtons,
      form,
      tableHeader = ["№", "Прізвище, ініціали студента", "Поточний контроль", "Підсумковий семестровий контроль",
        "Загальна оцінка"
      ],
      tableRow,
      tableMain = [],
      num = 1;

    formButtons = `<button name='closeForm'>Закрити</button>
      <button name='saveForm'>Зберегти</button>
      <button name='subscribe'>Підписати</button>`;

    form =
      `<div class="row">
        <label for="academicDiscipline">Навчальна дисципліна</label>
        <input type="text" name="formInput" id="academicDiscipline" placeholder="повна назва дисципліни за навчальним планом" value="${data.academicDiscipline}">
      </div>
      <div class="row">
        <label for="studyCredits">Кілкість крелитів</label>
        <input type="number" name="formInput" id="studyCredits" name="number" min="1" max="36" step="1" value="${data.studyCredits}">
      </div>`;
    controlFormData.unshift({
      key: 0,
      value: "Форма підсумкового контролю"
    });
    form += `<div class="row">${generateSelect(controlFormData, "controlForm")}</div>`
    form +=
      `<div class="row">
        <label for="date">Дата контролю</label>
        <input type="date" name="formInput" id="date" value="${data.date}">
      </div>
      <div class="row">
        <label for="teacherFullName">посади і ПІБ викладачів, які виставляють підсумкову оцінку</label>
        <input type="text" name="formInput" id="teacherFullName" value="${data.teacherFullName}">
      </div>
      <div class="row">
        <label for="aditionalTeachers">посади і ПІБ викладачів, які проводили практичні (семінарські, лабораторні) заняття й здійснювали поточний контроль</label>
        <input type="text" name="formInput" id="aditionalTeachers" placeholder="введіть через кому" value="${data.aditionalTeachers.join(", ")}">
      </div>`;

    let arrFildTabie = ["name", "currentGrade", "semesterGrade", "gradeSum"];

    data.students.forEach(el => {
      tableRow = [num];
      arrFildTabie.forEach(key => {
        switch (key) {
          case "name":
          tableRow.push(el[key]);
            break;
          case "gradeSum":
          tableRow.push(`<input type="text" name="tableInput" id="${key + "-" + num}" value="${el[key]}" disabled>`);
            break;
          default:
          tableRow.push(`<input type="text" name="tableInput" id="${key + "-" + num}" value="${el[key]}">`);
        }
      });
      ++num;
      tableMain.push(tableRow);
    });
    tableMain.unshift(tableHeader);
    form += createTable(tableMain, "formTable");

    document.getElementById("formButtons").innerHTML = formButtons;
    document.getElementById("form").innerHTML = form;
    document.getElementById("controlForm").value = +data.controlForm;
  }
</script>